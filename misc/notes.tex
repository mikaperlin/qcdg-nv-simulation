\documentclass[11pt]{article}

%%% standard header
\usepackage[margin=1in]{geometry} % one inch margins
\usepackage{fancyhdr} % easier header and footer management
\pagestyle{fancyplain} % page formatting style
\usepackage{hyperref} % for linking references
\setlength{\parindent}{0cm} % don't indent new paragraphs...
\parskip 6pt % ... place a space between paragraphs instead
\usepackage[inline]{enumitem} % include for \setlist{}, use below
%\setlist{nolistsep} % more compact spacing between environments
\setlist[itemize]{leftmargin=*} % nice margins for itemize ...
\setlist[enumerate]{leftmargin=*} % ... and enumerate environments
\frenchspacing % add a single space after a period
\usepackage{lastpage} % for referencing last page
\cfoot{\thepage~of \pageref{LastPage}} % "x of y" page labeling

%%% symbols, notations, etc.
\usepackage{physics,braket,bm,commath,amssymb} % physics packages
\renewcommand{\t}{\text} % text in math mode
\newcommand{\f}[2]{\dfrac{#1}{#2}} % shorthand for fractions
\newcommand{\p}[1]{\left(#1\right)} % parenthesis
\renewcommand{\sp}[1]{\left[#1\right]} % square parenthesis
\renewcommand{\set}[1]{\left\{#1\right\}} % curly parenthesis
\renewcommand{\v}{\bm} % bold vectors
\newcommand{\uv}[1]{\hat{\v{#1}}} % unit vectors
\newcommand{\av}{\vec} % arrow vectors
\renewcommand{\del}{\nabla} % del operator
\renewcommand{\d}{\partial} % partial d
\renewcommand{\c}{\cdot} % inner product
\newcommand{\w}{\wedge} % wedge product
\newcommand{\bk}{\Braket} % shorthand for braket notation
\let\vepsilon\epsilon % remap normal epsilon to vepsilon
\let\vphi\phi % remap normal phi to vphi
\newcommand{\eps}{\varepsilon} % prettier epsilon
\renewcommand{\phi}{\varphi} % prettier phi
\renewcommand{\l}{\ell} % prettier l
\newcommand{\m}[1]{\begin{pmatrix}#1\end{pmatrix}} % matrix
\newcommand{\vm}[1]{\begin{vmatrix}#1\end{vmatrix}} % determinant


%%% sections
\usepackage{sectsty,titlesec} % section options
\sectionfont{\large} % section font size
\subsectionfont{\normalsize} % subsection font size

\renewcommand{\headrulewidth}{0.5pt} % horizontal line in header
\lhead{Michael A. Perlin}

\renewcommand{\u}{\uparrow}
\renewcommand{\d}{\downarrow}
\newcommand{\E}{\mathcal E}
\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil{#1}\right\rceil}

\begin{document}
\titlespacing{\section}{0pt}{6pt}{0pt} % section placement
\titlespacing{\subsection}{5mm}{6pt}{0pt} % subsection placement

\section*{Prefix}

\subsection*{Projections}

The projection operator $P\sp{\v v,I\v u}$ projects $\v v$ onto the
plane $I\v u$ (i.e. the plane orthogonal to $\v u$), and is is defined
by:
\begin{align}
  P\sp{\v v,I\v u}=\v v-\v v\c\uv u\uv u
\end{align}

\subsection*{Rotations}

The rotation operator $R\sp{\v v,I\v\phi}$ rotates the vector $\v v$
by $\phi$ in the plane $I\uv\phi$, and is defined by
\begin{align}
  R\sp{\v v,I\phi\uv z}=\p{v_x\cos\phi-v_y\sin\phi}\uv
  x+\p{v_y\cos\phi+v_x\sin\phi}\uv y+v_z\uv z.
\end{align}
which may also be written as
\begin{align}
  R\sp{\v v,I\v\phi}=P\sp{\v v,I\uv\phi}\cos\phi+\uv\phi\times\v
  v\sin\phi+\v v\c\uv\phi\uv\phi,
\end{align}
If we choose coordinates in which $\v v=v_x\uv x+v_z\uv z$,
i.e. $v_y=0$, then
\begin{align}
  R\sp{\v v,I\phi\uv z}=v_x\p{\cos\phi\uv x+\sin\phi\uv y}+v_z\uv z.
\end{align}

We will define the frequently used operator
\begin{align}
  P_\perp\sp{\v v,I\v u}=R\sp{P\sp{\v v,I\uv u},\f\pi2 I\uv u} =\uv
  u\times\v v.
\end{align}

\newpage
\section*{NV system}

We have the total system Hamiltonian
\begin{align}
  H_{\t{sys}}=H_{\t{NV}}^{\t{GS}}+H_{\t{hf}}+H_{\t{nZ}}+H_{\t{nn}},
\end{align}
where
\begin{align}
  H_{\t{NV}}^{\t{GS}}=D\p{\v S\c\uv z}^2-\gamma_e\v B\c\v S
\end{align}
is the ground state Hamiltonian of the NV center. Here $\uv z$ is the
natural axis of the NV center.

The hyperfine Hamiltonian is
\begin{align}
  H_{\t{hf}}=\sum_j\f{\gamma_e\gamma_j}{4\pi r_j^3} \sp{\v S\c\v I_j
    -3\p{\v S\c\v r_j}\p{\v I_j\c\v r_j}},
\end{align}
where $\gamma_j$ and $\v I_j$ are, respectively, the gyromagnetic
ratio and spin of nucleus $j$. This Hamiltonian accounts for the
interaction between the NV center and the spin of atomic nuclei.

The nuclear Zeeman Hamiltonian which accounts for the interaction
between the atomic nuclei and the external magnetic field is
\begin{align}
  H_{\t{nZ}}=-\sum_j\gamma_j\v B\c\v I_j.
\end{align}

Finally, the internuclear spin-spin interaction Hamiltonian is
\begin{align}
  H_{\t{nn}}=\sum_{j<k}\f{\gamma_j\gamma_k}{4\pi r_{jk}^3}\sp{\v
    I_j\c\v I_k-3\p{\v I_j\c\v r_{jk}}\p{\v I_k\c\v r_{jk}}}.
\end{align}

Letting $\v B=B_z\uv z$, the Hamiltonian $H_{\t{NV}}^{\t{GS}}$ becomes
\begin{align}
  H_{\t{NV}}^{\t{GS}}=DS_z^2-\gamma_eB_zS_z.
\end{align}
Changing into the frame of this $H_{\t{NV}}^{\t{GS}}$ affects only the
hyperfine Hamiltonian, which becomes
\begin{align}
  H_{\t{hf}}'\approx S_z\sum_j\v A_j\c\v I_j,
\end{align}
where we define the hyperfine field
\begin{align}
  \v A_j=\f{\gamma_e\gamma_j}{4\pi r_j^3}\sp{\uv z-3\p{\uv r_j\c\uv
      z}\uv r_j}.
\end{align}

When restricted to the subspace of $\set{\ket0,\ket{m_s}}$ for NV
center spins ($m_s=\pm1$), we can say that
\begin{align}
  S_z=\f12m_s\p{\sigma_z+1},
\end{align}
where $\sigma_z=\op{m_s}-\op0$. Defining the interaction Hamiltonian
\begin{align}
  H_{\t{int}}=\f12m_s\sigma_z\sum_j\v A_j\c\v I_j
\end{align}
and the effective nuclear Zeeman Hamiltonian
\begin{align}
  H_{\t{nZ}}^{\t{eff}}=-\sum_j\p{\gamma_jB_z\uv z-\f{m_s}2\v A_j}\c\v
  I_j \equiv-\sum_j\v\omega_j\c\v I_j,
\end{align}
we can say that
\begin{align}
  H_{\t{sys}}'=H_{\t{hf}}'+H_{\t{nZ}}+H_{\t{nn}}
  =H_{\t{int}}+H_{\t{nZ}}^{\t{eff}}+H_{\t{nn}}.
\end{align}

\newpage
\section*{Decoupling nuclear spins}

We add an auxiliary radio frequency decoupling field
\begin{align}
  \v B_{\t{rfd}}
  =V_{\t{rfd}}\cos\p{\omega_{\t{rfd}}t-\phi_{\t{rfd}}}\uv n_{\t{rfd}}
\end{align}
with $\omega_{\t{rfd}}\sim\gamma_jB_z\gg\gamma_jV_{\t{rfd}}$, so that
we get the additional Hamiltonian
\begin{align}
  H_\t{rfd}=\sum_j\gamma_jV_{\t{rfd}}\cos\p{\omega_{\t{rfd}}
    t-\phi_{\t{rfd}}}\uv n_{\t{rfd}}\c\v I_j.
\end{align}
Here we neglect the field's coupling to the NV center by the secular
approximation. Defining
\begin{align}
  H_{\t{n}}=H_{\t{nZ}}^{\t{eff}}+H_{\t{rfd}},
\end{align}
the propagator for $H_n$ can be written as
\begin{align}
  U_n=U_{\t{nZ}}^{\t{eff}}\tilde U_{\t{rfd}},
\end{align}
where, after making a rotating wave approximation for $H_{\t{rfd}}$,
changing into the frame of $H_{\t{nZ}}^{\t{eff}}$, and making a
secular approximation with $\omega_j\gg\gamma_jV_{\t{rfd}}$,
\begin{align}
  \tilde H_{\t{rfd}}\approx\sum_j\f12\gamma_jV_{\t{rfd}} R\sp{P\sp{\uv
      n_{\t{rfd}},I\uv\omega_j},
    \p{\phi_{\t{rfd}}-\sp{\omega_{\t{rfd}}-\omega_j}t}I\uv\omega_j}
  \c\v I_j.
\end{align}
The time dependence in $U_{\t{rfd}}$ can be removed in the frame of
\begin{align}
  H_f=-\sum_j\p{\omega_{\t{rfd}}-\omega_j}\uv\omega_j\c\v I_j,
\end{align}
such that
\begin{align}
  \tilde U_{\t{rfd}}=U_fU_\nu,
\end{align}
where
\begin{align}
  H_\nu=\sum_j\v\nu_j\c\v I_j
\end{align}
and
\begin{align}
  \v\nu_j=\f12\gamma_jV_{\t{rfd}} R\sp{P\sp{\uv n,
      I\uv\omega_j},\phi_{\t{rfd}}\uv\omega_j}
  +\p{\omega_{\t{rfd}}-\omega_j}\uv\omega_j\equiv\v\Omega_j+
  \epsilon_j\uv\omega_j,
\end{align}
where $\v\Omega_j\perp\uv\omega_j$. Note that
$\Omega_j=\f12\gamma_jV_{\t{rfd}}\sqrt{1-\abs{\uv
    n\c\uv\omega_j}^2}$. We finally have that
\begin{align}
  U_n=U_{\t{nZ}}^{\t{eff}}U_fU_\nu=U_\omega U_\nu,
\end{align}
with
\begin{align}
  H_\omega=-\omega_{\t{rfd}}\sum_j\uv\omega_j\c\v I_j.
\end{align}
In the fame of $H_\omega$, after making a secular approximation with
$\omega_{\t{rfd}}\gg\gamma_jV_{\t{rfd}}$ and $\gamma_jB_z\gg\abs{\v
  A_j}$ (so $\uv\omega_j\approx\uv z$), the internuclear coupling
Hamiltonian becomes
\begin{align}
  \tilde H_{\t{nn}}&\approx\sum_{j<k}\f{\gamma_j\gamma_k}{4\pi
    r_{jk}^3}
  \f12\sp{1-3\p{\uv r_{jk}\c\uv z}^2}\p{3I_j^zI_k^z-\v I_j\c\v I_k} \\
  &=\sum_{j<k}\f{\gamma_j\gamma_k}{4\pi r_{jk}^3} \f12\sp{1-3\p{\uv
      r_{jk}\c\uv z}^2} \sp{3\p{\v I_j\c\uv z}\p{\v I_k\c\uv z}-\v
    I_j\c\v I_k}.
\end{align}
This Hamiltonian vanishes in a frame where all $\v I_n$ rotate (at a
frequency much greater than the prefactors in $H_{\t{nn}}$) about an
axis which makes an angle $\arccos\p{1/\sqrt3}$ with the $\uv z$ axis,
so that $3\p{\tilde{\v I_j}\c\uv z}\p{\tilde{\v I_k}\c\uv z}=\v
I_j\c\v I_k$. This precession occurs precisely in the frame of $H_\nu$
if $\Omega_j\approx\sqrt2\p{\omega_{\t{rfd}}-\omega_j}$, such that
$\v\nu_j$ makes the necessary angle with the $\uv z$ axis and
$\nu_j\sim\gamma_jV_{\t{rfd}}$ is much greater than the prefactors in
$H_{\t{nn}}$. Alternately, we can say that if $\Delta=\Omega_j/\sqrt2$
and $\delta_j=\p{\omega_{\t{rfd}}-\omega_j}-\Delta$, the nuclear
coupling $H_{\t{nn}}$ vanishes so long as $\delta_j/\Delta\ll 1$.

\newpage
\section*{Dynamic decoupling of the NV center and single nuclear spin
  addressing}

To shield the NV center from environmental noise, we use dynamic
decoupling schemes which periodically flip the NV spin state
$\ket0\leftrightarrow\ket{m_s}$. This decoupling effectively prepends
a modulation function $F\p{t}\in\set{-1,1}$ to the interaction
Hamiltonian, so that
\begin{align}
  H_{\t{int}}=\f12F\p{t}m_s\sigma_z\sum_j\v A_j\c\v I_j.
\end{align}
In the frame of $H_n=H_{\t{nZ}}^{\t{eff}}+H_{\t{rfd}}$,
\begin{align}
  \tilde H_{\t{int}}=\f12F\p{t}m_s\sigma_z\sum_j\tilde{\v A_j}\c\v
  I_j,
\end{align}
where
\begin{align}
  \tilde{\v A_j}=R\sp{R\sp{\v A_j,\omega_{\t{rfd}}I\uv\omega_jt},
    -I\v\nu_jt}.
\end{align}
Expanding $F\p{t}$ in a Fourier series,
\begin{align}
  \tilde H_{\t{int}}=\f12m_s\sigma_z\sum_kf_k\cos\p{k\omega_{DD}t}
  \sum_j\tilde{\v A_j}\c\v I_j.
\end{align}
Defining
\begin{align}
  \v A_n^z=\v A_n\c\uv\omega_n\uv\omega_n, && \v A_n^x=P\sp{\v
    A_n,I\uv\omega_n}, && \v A_n^y=P_\perp\sp{\v A_n,I\uv\omega_n},
\end{align}
when some harmonic
\begin{align}
  k_{DD}\omega_{DD}=\omega_{\t{rfd}}\pm\nu_n
  =\omega_n+\p{1\pm\sqrt3}\Delta
\end{align}
and $\abs{\omega_n-\omega_j}\gg\abs{f_{k_{DD}}\v A_j}$ for all $j\ne
n$ (which we can achieve by making $f_{k_{DD}}$ arbitrarily small), we
get, by the rotating wave approximation, % fixme: prove
\begin{align}
  \tilde H_{\t{int}}\approx\f18m_sf_{k_{DD}}\sigma_z\v a_n^\pm\c\v
  I_j,
\end{align}
where
\begin{align}
  \v a_n^\pm=P\sp{\v A_n^x,I\uv\nu_n}\pm P_\perp\sp{\v
    A_n^y,I\uv\nu_n} =P\sp{P\sp{\v A_n,I\uv\omega_n},I\uv\nu_n}\pm
  P_\perp\sp{P_\perp\sp{\v A_n,I\uv\omega_n},I\uv\nu_n}.
\end{align}
If instead some harmonic $k_{DD}\omega_{DD}=\nu_n$, then
\begin{align}
  \tilde H_{\t{int}}\approx\f14m_sf_{k_{DD}}\sigma_z\v a_n^z\c\v I_n,
\end{align}
with
\begin{align}
  \v a_n^z=P\sp{\v A_n^z,I\uv\nu_n} =P\sp{\v
    A_n\c\uv\omega_n\uv\omega_n,I\uv\nu_n}.
\end{align}

Using this information, we can measure all $\v A_j$.

\newpage
\section*{Nuclear spin control}

We applying a radio frequency control field with the Hamiltonian
\begin{align}
  H_{\t{rfc}}=\sum_j\gamma_jV_{\t{rfc}}\cos\p{\omega_{\t{rfc}}t-\phi_{\t{rfc}}}
  \uv m_{\t{rfc}}\c\uv I_j.
\end{align}
Using
$\gamma_nV_{\t{rfc}}\ll\abs{\omega_{\t{rfd}}-\omega_n}\ll\omega_{\t{rfd}}$
and $\gamma_nV_{\t{rfc}}\ll\abs{\omega_n-\omega_j}$, when
\begin{align}
  \omega_{\t{rfc}}=\omega_{\t{rfd}}\pm\nu_n=\omega_n+\p{1\pm\sqrt3}\Delta
\end{align}
we effectively have
\begin{align}
  H_{\t{ctl}}\approx\f14\gamma_nV_{\t{rfc}}\v b_n^\pm\c\v I_n,
\end{align}
with
\begin{align}
  \v b_n^\pm=P\sp{\v m_n^x,I\uv\nu_n}\pm P_\perp\sp{\v m_n^y,
    I\uv\nu_n},
\end{align}
and
\begin{align}
  \v m_n^x=R\sp{P\sp{\uv m_{\t{rfc}},I\uv\omega_n},
    \phi_{\t{rfc}}I\uv\omega_n}, && \v m_n^y=R\sp{P_\perp\sp{\uv
      m_{\t{rfc}},I\uv\omega_n}, \phi_{\t{rfc}}I\uv\omega_n}, && \v
  m_n^z=\uv m_{\t{rfc}}\c\uv\omega_n\uv\omega_n.
\end{align}
Expanding,
\begin{align}
  \v b_n^\pm=P\sp{R\sp{P\sp{\uv m_{\t{rfc}},I\uv\omega_n}, \phi
      I\uv\omega_n},I\uv\nu_n}\pm P_\perp\sp{R\sp{P_\perp\sp{\uv
        m_{\t{rfc}},I\uv\omega_n},\phi I\uv\omega_n},I\uv\nu_n}.
\end{align}

If instead $\omega_{\t{rfc}}=\nu_n$, then
\begin{align}
  H_{\t{ctl}}\approx\f12\gamma_nV_{\t{rfc}}\v b_n^z\c\v I_n,
\end{align}
with
\begin{align}
  \v b_n^z=R\sp{P\sp{\v m_n^z,I\uv\nu_n},-\phi_{\t{rfc}}I\uv\nu_n}
  =R\sp{P\sp{\uv m_{\t{rfc}}\c\uv\omega_n\uv\omega_n,I\uv\nu_n},
    -\phi_{\t{rfc}}I\uv\nu_n}.
\end{align}

\newpage
\section*{Individual nuclear spin coupling and control summary}

To summarize, we have the following tools at hand to couple the NV
center to nuclei:
\begin{align}
  H_{\t{int}}^\pm=\f18m_sf_{k_{DD}}\sigma_z\v a_n^\pm\c\v I_n
  =\alpha_n^\pm\sigma_z\uv a_n^\pm\c\v I_n, &&
  H_{\t{int}}^z=\f14m_sf_{k_{DD}}\sigma_z\v a_n^z\c\v I_n,
  =\alpha_n^z\sigma_z\uv a_n^z\c\v I_n
\end{align}
where
\begin{align}
  \v a_n^\pm=P\sp{\v A_n^x,I\uv\nu_n}\pm P_\perp\sp{\v
    A_n^y,I\uv\nu_n} =P\sp{P\sp{\v A_n,I\uv\omega_n},I\uv\nu_n}\pm
  P_\perp\sp{P_\perp\sp{\v A_n,I\uv\omega_n},I\uv\nu_n}.
\end{align}
and
\begin{align}
  \v a_n^z=P\sp{\v A_n^z,I\uv\nu_n} =P\sp{\v
    A_n\c\uv\omega_n\uv\omega_n,I\uv\nu_n}.
\end{align}

In order to control individual nuclei, we have:
\begin{align}
  H_{\t{ctl}}\approx\f14\gamma_nV_{\t{rfc}}\v b_n^\pm\c\v I_n
  =\beta_n^\pm\uv b_n^\pm\c\v I_n, &&
  H_{\t{ctl}}\approx\f12\gamma_nV_{\t{rfc}}\v b_n^z\c\v I_n
  =\beta_n^z\uv b_n^\pm\c\v I_n,
\end{align}
where
\begin{multline}
  \v b_n^\pm=P\sp{\v m_n^x,I\uv\nu_n}\pm P_\perp\sp{\v m_n^y,
    I\uv\nu_n} \\
  =P\sp{R\sp{P\sp{\uv m_{\t{rfc}},I\uv\omega_n}, \phi
      I\uv\omega_n},I\uv\nu_n}\pm P_\perp\sp{R\sp{P_\perp\sp{\uv
        m_{\t{rfc}},I\uv\omega_n},\phi I\uv\omega_n},I\uv\nu_n},
\end{multline}
and
\begin{align}
  \v b_n^z=R\sp{P\sp{\v m_n^z,I\uv\nu_n},-\phi_{\t{rfc}}I\uv\nu_n}
  =R\sp{P\sp{\uv m_{\t{rfc}}\c\uv\omega_n\uv\omega_n,I\uv\nu_n},
    -\phi_{\t{rfc}}I\uv\nu_n}.
\end{align}

Here we have full control over the orientation of $\uv\nu_n$
($I\uv\nu_n$), with the restriction that it makes an angle
$\theta_m=\arccos\p{1/\sqrt3}\approx0.3\pi$ with $\uv z$ ($\uv x\uv
y$).

A choice of $\uv\nu_n$ fixes $\uv a_n^z$, which will always make an
angle $\pi/2-\theta_m\approx0.2\pi$ with $\uv z$. We can rotate
$\uv\nu_n$ in $\uv x\uv y$ to change the directions of $\uv a_n^\pm$,
both of which will always lie in $I\uv\nu_n$. Unless $P\sp{\v A_n,\uv
  x\uv y}=\v 0$, it should be possible to orient $\uv a_n^\pm$ in the
$\uv x\uv y$ plane, at an angle of $\pi/2$ with $\uv a_n^z$. We can
therefore effectively create an interaction Hamiltonian of the form
\begin{align}
  H_{\t{int},n}=h\sigma_z^{NV}\sigma_{z'}^n,
\end{align}
where $\uv z'$ lies in the $I\uv\nu_j$ plane. We can, however,
initially rotate one of the spin axes into the other, perform logical
operations, and then rotate back to get the effective Hamiltonian
\begin{align}
  \tilde H_{\t{int},n}=R^\dagger
  H_{\t{int},n}R=h\sigma_z^{NV}\sigma_z^n.
\end{align}

The directions of $\uv b_n^z$ and one of $\uv b_n^\pm$ may be
determined within $I\uv\nu_n$ at will, so we can effectively create a
control Hamiltonian
\begin{align}
  H_{\t{ctl},n}=h_{z'}\sigma_{z'}^n+h_{x'}\sigma_{x'}^n.
\end{align}
Finally, we have arbitrary control over the NV center with the
Hamiltonians
\begin{align}
  H_{NV}=h_z\sigma_z^{NV}+h_x\sigma_x^{NV}+h_y\sigma_y^{NV}.
\end{align}

\newpage
\section*{Single qubit logic gates}

In this section we work in the following basis:
\begin{align}
  \ket\u=\m{1\\0}, && \ket\d=\m{0\\1}.
\end{align}

We have Hamiltonians of the form $H_\alpha=h\sigma_\alpha$, with the
respective propagators $U_\alpha=\exp\p{-iH_\alpha t}$. We can use
these propagators to implement the rotation operators
\begin{align}
  R_z\p\phi=\m{e^{-i\phi/2}&0\\0&e^{i\phi/2}}=U_z\p{\f\phi2},
\end{align}
\begin{align}
  R_x\p\phi=\m{\cos\p{\phi/2}&-i\sin\p{\phi/2}\\
    -i\sin\p{\phi/2}&\cos\p{\phi/2}}=U_x\p{\f\phi2},
\end{align}
and
\begin{align}
  R_y\p\phi=\m{\cos\p{\phi/2}&-\sin\p{\phi/2}\\
    \sin\p{\phi/2}&\cos\p{\phi/2}}=U_y\p{\f\phi2}.
\end{align}
Particularly interesting special cases of these operators include the
phase shift and bit-flit gates
\begin{align}
  Z=\m{1&0\\0&-1}\cong R_z\p\pi, && X=\m{0&1\\1&0}\cong R_x\p\pi.
\end{align}

When we have $H_{\t{HG}}=h\p{\uv z+\uv x}/\sqrt2$, we get the
propagator
\begin{align}
  U_{\t{HG}}=\cos\p{ht}-i\sin\p{ht}\f{\sigma_z+\sigma_x}{\sqrt2}
\end{align}
which allows us to implement the Hadamard gate
\begin{align}
  \t{HG}=\f{1}{\sqrt2}\m{1&1\\1&-1}\cong U_{\t{HG}}\p{\f\pi2}.
\end{align}

\newpage
\section*{Two qubit logic gates}

In this section we work in the following basis:
\begin{align}
  \ket{\u\u}=\m{1\\0\\0\\0}, && \ket{\u\d}=\m{0\\1\\0\\0}, &&
  \ket{\d\u}=\m{0\\0\\1\\0}, && \ket{\d\d}=\m{0\\0\\0\\1}.
\end{align}

We have Hamiltonians of the form
$H_{\alpha\beta}=h\sigma_\alpha^1\sigma_\beta^2$, with the respective
propagators $U_{\alpha\beta}\p{ht}=\exp\p{-iH_{\alpha\beta}t}$. We can
use these propagators together with the single-qubit phase shift gates
to implement the controlled phase shift gates
\begin{align}
  \t{c}R_{\u\u}\p\phi
  &=\m{e^{i \phi} & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 1}, & \t{c}R_{\u\d}\p\phi
  &=\m{1 & 0 & 0 & 0 \\
    0 & e^{i \phi} & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 1}, \\
  \t{c}R_{\d\u}\p\phi
  &=\m{1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & e^{i \phi} & 0 \\
    0 & 0 & 0 & 1} & \t{c}R\p\phi\equiv\t{c}R_{\d\d}\p\phi
  &=\m{1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & e^{i \phi}}.
\end{align}
We also define the controlled phase flip ($\t{c}Z$) and controlled NOT
($\t{cNOT}$) gates
\begin{align}
  \t{c}Z&=\m{1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & -1}, &
  \t{cNOT}&=\m{1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 0 & 1 \\
    0 & 0 & 1 & 0},
\end{align}
and, finally, the SWAP, $\sqrt{\t{SWAP}}$, $i$SWAP, and
$\sqrt{i\t{SWAP}}$ gates
\begin{align}
  \t{SWAP}
  &=\m{1 & 0 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 0 & 1}, & \sqrt{\t{SWAP}}
  &=\m{1 & 0 & 0 & 0 \\
    0 & \p{1+i}/2 & \p{1-i}/2 & 0 \\
    0 & \p{1-i}/2 & \p{1+i}/2 & 0\\
    0 & 0 & 0 & 1} \\
  i\t{SWAP}
  &=\m{1 & 0 & 0 & 0 \\
    0 & 0 & i & 0 \\
    0 & i & 0 & 0 \\
    0 & 0 & 0 & 1}, & \sqrt{i\t{SWAP}}
  &=\m{1 & 0 & 0 & 0 \\
    0 & 1/\sqrt2 & i/\sqrt2 & 0 \\
    0 & i/\sqrt2 & 1/\sqrt2 & 0 \\
    0 & 0 & 0 & 1}.
\end{align}

The swap gate can be used to generate any two-qubit operation
$\mathcal O_{m,n}$ between spins $n$ and $m$ through an intermediate
spin $p$ via
\begin{align}
  \mathcal O_{m,n}=\t{SWAP}_{p,m}\mathcal O_{p,n}\t{SWAP}_{p,m}.
\end{align}


\newpage
\section*{Gate generation}

We have a gate $G$, which is generated by the propagator
\begin{align}
  U\sp{G,t}=\exp\p{-i\int_0^tdt'H\sp{G,t'}}.
\end{align}
We wish to solve for $H\sp{G,t}$ so that $U\sp{G,t_0}=G$. If we assume
$H\sp{G}$ is independent of time, then
\begin{align}
  G=\exp\p{-it_0H\sp{G}},
\end{align}
and so
\begin{align}
  t_0H\sp{G}=i\ln G. \label{lnG}
\end{align}
Knowing that $t_0H\sp{G}$ takes the form
\begin{align}
  t_0H\sp{G}
  =\sum_{\alpha,\beta}h_{\alpha,\beta}^{1,2}\sigma_\alpha^1\sigma_\beta^2,
  \label{H_G}
\end{align}
where $\alpha,\beta\in\set{I,x,y,z}$ and $n\in\set{1,2}$ (with
$\sigma_I\equiv I_2$), we have reduced finding $H\sp{G}$ to a linear
algebra problem: pick a gate $G$, compute $i\ln G$, and find coupling
strengths $h_{\alpha,\beta}^{1,2}$ in (\ref{H_G}) which satisfy
(\ref{lnG}).

Using this technique, up to global phase we can find that
\begin{align}
  t_0H\sp{\t{c}R_{\u\u}\p\phi}&=-\f\phi4\p{\sigma_z^1+\sigma_z^2
    +\sigma_z^1\sigma_z^2}, &
  t_0H\sp{\t{c}R_{\u\d}\p\phi}&=\f\phi4\p{-\sigma_z^1+\sigma_z^2
    +\sigma_z^1\sigma_z^2}, \\
  t_0H\sp{\t{c}R_{\d\u}\p\phi}&=\f\phi4\p{\sigma_z^1-\sigma_z^2
    +\sigma_z^1\sigma_z^2}, & t_0H\sp{\t{c}R_{\d\d}\p\phi}
  &=\f\phi4\p{\sigma_z^1+\sigma_z^2 -\sigma_z^1\sigma_z^2},
\end{align}
\begin{align}
  t_0H\sp{\t{c}Z}
  &=\f\pi4\p{\sigma_z^1+\sigma_z^2-\sigma_z^1\sigma_z^2}, &
  t_0H\sp{\t{cNOT}}
  &=\f\pi4\p{\sigma_z^1+\sigma_x^2-\sigma_z^1\sigma_x^2},
\end{align}
\begin{align}
  t_0H\sp{\t{SWAP}}&=\f\pi4\p{\sigma_z^1\sigma_z^2
    +\sigma_x^1\sigma_x^2+\sigma_y^1\sigma_y^2}, &
  t_0H\sp{\sqrt{\t{SWAP}}}&=\f12t_0H\sp{\t{SWAP}}, \\
  t_0H\sp{i\t{SWAP}}&=-\f\pi4\p{\sigma_x^1\sigma_x^2
    +\sigma_y^1\sigma_y^2}, &
  t_0H\sp{\sqrt{i\t{SWAP}}}&=\f12t_0H\sp{i\t{SWAP}},
\end{align}

\newpage
\section*{Nuclear placement on a diamond lattice}

The positions $\v s$ of any nucleus in a diamond lattice can be
written in terms of a reduced position $\v r$ as
\begin{align}
  \v s=\f{a}2\v r=\f{a}2\p{b\v a_0+\l\v a_1+m\v a_2+n\v a_3} \equiv
  \f{a}2\sp{b\v a_0+\sum_ic_i\v a_i}
\end{align}
for $b\in\set{0,1}$; $\l,m,n\in\mathbb{Z}$;
\begin{align}
  \v a_0=\f12\p{\uv x+\uv y+\uv z}; && \v a_1=\uv y+\uv z; && \v
  a_2=\uv z+\uv x; && \v a_3=\uv x+\uv y;
\end{align}
and $a\approx0.35668~\t{nm}$. We will find it useful to note that:
\begin{align}
  \v a_0\c\v a_0=\f34, && \v a_0\c\v a_i=1, && \v a_i\c\v a_i=2, && \v
  a_i\c\v a_{j\ne i}=1.
\end{align}
The positions for which $\l=m=n=0$ are reserved for the NV center.

\section*{Conditions for larmor equality}

Two nuclei are said to be {\it larmor equal}, or a {\it larmor pair},
if they have the same effective larmor frequency
\begin{align}
  \omega_j=\abs{\gamma_j B_z\uv a_0-\f{m_s}2\v A_j}.
\end{align}
This equality occurs when the reduced positions $\v r$ and $\v s'$ of
two $^{13}$C nuclei simultaneously satisfy
\begin{align}
  \abs{\v r\c\v a_0}=\abs{\v r'\c\v a_0}, \label{condA0}
\end{align}
and
\begin{align}
  \abs{\v r-\v r\c\uv a_0\uv a_0}^2 =\abs{\v r'-\v r'\c\uv a_0\uv
    a_0}^2. \label{condB0}
\end{align}

Expanding condition (\ref{condA0}) yields
\begin{align}
  \abs{\f34b+\l+m+n}=\abs{\f34b'+\l'+m'+n'}. \label{condA}
\end{align}
The fact that all variables here are integers implies that
\begin{align}
  b=b', \label{condAa}
\end{align}
\begin{align}
  \abs{\l+m+n}=\abs{\l'+m'+n'}. \label{condAb}
\end{align}

We can expand part of (\ref{condB0}) as
\begin{align}
  \v r-\v r\c\uv a_0\uv a_0
  &=\v r-\v r\c\v a_0\v a_0a_0^{-2} \\
  &=b\v a_0+\sum_ic_i\v a_i-\p{\f34b+\sum_ic_i}\v a_0\f43 \\
  &=b\v a_0+\sum_ic_i\v a_i-b\v a_0-\f43\sum_ic_i\v a_0 \\
  &=\sum_ic_i\p{\v a_i-\f43\v a_0}.
\end{align}
Letting $\set{i,j,k}=\set{1,2,3}$, we can simplify this result to
\begin{align}
  \v r-\v r\c\uv a_0\uv a_0
  &=\sum_ic_i\sp{\uv x^j+\uv x^k-\f23\p{\uv x^i+\uv x^j+\uv x^k}} \\
  &=\f13\sum_ic_i\p{-2\uv x^i+\uv x^j+\uv x^k} \\
  &=\f13\sum_i\p{-2c_i+c_j+c_k}\uv x^i.
\end{align}
The squared magnitude of this quantity is
\begin{align}
  \abs{\v r-\v r\c\uv a_0\uv a_0}^2
  &=\f19\sum_i\p{-2c_i+c_j+c_k}^2 \\
  &=\f19\sum_i\p{4c_i^2+c_j^2+c_k^2-4c_ic_j-4c_ic_k+2c_jc_k} \\
  &=\f23\sp{\p{\l^2+m^2+n^2}-\p{mn+n\l+\l m}} \\
  &=\l^2+m^2+n^2-\f13\p{\l+m+n}^2.
\end{align}
Condition (\ref{condB0}) is therefore equivalently
\begin{align}
  \l^2+m^2+n^2-\f13\p{\l+m+n}^2
  ={\l'}^2+{m'}^2+{n'}^2-\f13\p{\l'+m'+n'}^2. \label{condB}
\end{align}
Larmor equality of two nuclei therefore equivalent to simultaneously
satisfying (\ref{condAa}), (\ref{condAb}), and (\ref{condB}).

\section*{Search space restrictions from a hyperfine cutoff}

We may wish to restrict our search for larmor pairs to nuclei for
which
\begin{align}
  \abs{\v A}>A_{\t{min}}, \label{condC0}
\end{align}
where
\begin{align}
  \v A=\f{\gamma_e\gamma_c}{4\pi s^3}\sp{\uv a_0-3\p{\uv s\c\uv
      a_0}\uv s} =\f{2\gamma_e\gamma_c}{\pi a^3r^3}\sp{\uv a_0-3\p{\uv
      r\c\uv a_0}\uv r}\equiv \f{\alpha}{r^3}\sp{\uv a_0-3\p{\uv
      r\c\uv a_0}\uv r}.
\end{align}
We can compute
\begin{align}
  \abs{\v A}^2=\f{\alpha^2}{r^6}\sp{1+9\p{\uv r\c\uv a_0}^2-6\p{\uv
      r\c\uv a_0}^2}=\f{\alpha^2}{r^6}\sp{1+3\p{\uv r\c\uv a_0}^2}.
\end{align}
This quantity is minimally
\begin{align}
  \floor{\abs{\v A}^2}=\f{\alpha^2}{r^6},
\end{align}
which means
\begin{align}
  \abs{\v A} \ge \f{\abs{\alpha}}{r^3} > A_{\t{min}}.
\end{align}
We can therefore restrict our search to nuclei for which
$\abs{\alpha}/r^3>A_{\t{min}}$, or equivalently
\begin{align}
  r^2<\p{\f{\abs{\alpha}}{A_{\t{min}}}}^{2/3}. \label{condC1}
\end{align}
We can expand $r^2$ as
\begin{align}
  r^2=\v r\c\v r
  &=\f34b^2+b\p{\l+m+n}+2\l^2+2m^2+2n^2+2mn+2n\l+2\l m \\
  &=b\p{\f34+\l+m+n}+\l^2+m^2+n^2+\p{\l+m+n}^2.
\end{align}
If $b=0$, then
\begin{align}
  r^2=\l^2+m^2+n^2+\p{\l+m+n}^2<\p{\f{\abs{\alpha}}{A_{\t{min}}}}^{2/3},
\end{align}
which means that each of $\l$, $m$, and $n$ must satisfy
\begin{align}
  \abs{c_i}<\p{\f{\abs{\alpha}}{A_{\t{min}}}}^{1/3}. \label{limit0}
\end{align}
If $b=1$, then
\begin{align}
  r^2&=\f34+\l+m+n+\l^2+m^2+n^2+\p{\l+m+n}^2 \\
  &=\p{\l+\f12}^2+\p{m+\f12}^2+\p{n+\f12}^2+\p{\l+m+n}^2,
\end{align}
and therefore each of $\l$, $m$, and $n$ must satisfy
\begin{align}
  \abs{c_i+\f12}<\p{\f{\abs{\alpha}}{A_{\t{min}}}}^{1/3},
\end{align}
which also implies
\begin{align}
  \abs{c_i}<\p{\f{\abs{\alpha}}{A_{\t{min}}}}^{1/3}+\f12.
  \label{limit1}
\end{align}
In performing a search for larmor pairs, we can use restriction
(\ref{limit1}) to limit our search space.

\section*{Computing the probability of occurrence}

If we have a set of $R$ lattice sites indexed by $(b,\l,m,n)$ mutually
satisfying (\ref{condA0}) and (\ref{condB0}), then the probability of
filling exactly $r$ of them with $^{13}$C nuclei is
\begin{align}
  P_{R,r}=p^r\p{1-p}^{R-r}\m{R\\r}=\f{R!~p^r\p{1-p}^{R-r}}{r!\p{R-r}!},
\end{align}
where $p$ is the probability that any particular site with a $^{13}$C
nucleus, i.e. the relative abundance of $^{13}$C. The probability of
having at least two $^{13}$C nuclei in these sites is therefore
\begin{align}
  P_{R,r\ge2}=\sum_{r=2}^RP_{R,r}=1-\p{P_{R,0}+P_{R,1}}.
\end{align}
If we have many such sets of lattice sites, then the total probability
$\bar P$ of having at least two sites filled within at least one set
of sites is
\begin{align}
  \bar P=1-\prod_R\p{1-P_{R,r\ge2}} =1-\prod_R\p{P_{R,0}+P_{R,1}}
  =1-\prod_R\p{1-p}^R\p{1+\f{Rp}{1-p}}.
\end{align}

\newpage
\section*{Singlet-triplet qubit initialization}

We can generate individual singlet and triplet-0 states via the
entanglement operator
\begin{align}
  \E=\f1{\sqrt2}
  \m{1 & 0 & 0 & 1 \\
    0 & 1 & 1 & 0 \\
    0 & -1 & 1 & 0 \\
    -1 & 0 & 0 & 1},
\end{align}
which maps $\ket{\u\d}\to\p{\ket{\u\d}-\ket{\d\u}}/\sqrt2\equiv\ket S$
and $\ket{\d\u}\to\p{\ket{\u\d}+\ket{\d\u}}/\sqrt2\equiv\ket T$. The
Hamiltonians to generate $\E$ and its inverse are
\begin{align}
  t_0H\sp{\mathcal E}&=-\f\pi4\sigma_y^1\sigma_x^2, & t_0H\sp{\mathcal
    E^\dag}&=\f\pi4\sigma_y^1\sigma_x^2.
\end{align}
We can generate superpositions of singlet and triplet-0 states of the
form
\begin{align}
  \ket\psi=\cos\theta\ket S+e^{i\phi}\sin\theta\ket T
\end{align}
via
\begin{align}
  \ket\psi=\E\sp{\cos\theta\ket{\u\d} +e^{i\phi}\sin\theta\ket{\d\u}},
\end{align}
which is in turn given by
\begin{align}
  \ket\psi\cong\E cR_{\d\u}\p{\phi}U_{yx}\p\theta\ket{\u\d}.
\end{align}
We therefore define the qubit initialization operator
\begin{multline}
  \mathcal Q\p{\theta,\phi}
  =\E cR_{\d\u}\p{\phi}U_{xx}\p\theta \\
  =\f{e^{-i\phi/4}}{\sqrt2}
  \m{ \cos\theta+\sin\theta & 0 & 0 & \cos\theta-\sin\theta \\
    0 & \cos\theta+e^{i\phi}\sin\theta &
    e^{i\phi}\cos\theta-\sin\theta & 0 \\
    0 & -\cos\theta+e^{i\phi}\sin\theta &
    e^{i\phi}\cos\theta+\sin\theta & 0 \\
    -\cos\theta+\sin\theta & 0 & 0 & \cos\theta+\sin\theta}
\end{multline}
so that
\begin{align}
  \mathcal Q\p{\theta,\phi}\ket{\u\d} \cong\cos\theta\ket S
  +e^{i\phi}\sin\theta\ket T.
\end{align}

\newpage
\section*{Singlet-triplet single qubit gates}

Letting $I_r=\op{\u\u}+\op{\d\d}$, we can implement the
singlet-triplet rotation gates
\begin{align}
  R_z^{ST}\p\phi=e^{-i\phi/2}\op S+e^{i\phi/2}\op T+I_r
  =\m{1 & 0 & 0 & 0 \\
    0 & \cos\p{\phi/2} & i \sin\p{\phi/2} & 0 \\
    0 & i \sin\p{\phi/2} & \cos\p{\phi/2} & 0 \\
    0 & 0 & 0 & 1},
\end{align}
\begin{multline}
  R_x^{ST}\p\phi=\cos\p{\f\phi2}\p{\op S+\op T}
  -i\sin\p{\f\phi2}\p{\op{T}{S}+\op{S}{T}}+I_r \\
  =\m{1 & 0 & 0 & 0 \\
    0 & e^{-i\phi/2} & 0 & 0 \\
    0 & 0 & e^{i\phi/2} & 0 \\
    0 & 0 & 0 & 1},
\end{multline}
\begin{multline}
  R_y^{ST}\p\phi=\cos\p{\f\phi2}\p{\op S+\op T}
  +\sin\p{\f\phi2}\p{-\op{S}{T}+\op{T}{S}}+I_r \\
  =\m{1 & 0 & 0 & 0 \\
    0 & \cos\p{\phi/2} & -\sin\p{\phi/2} & 0 \\
    0 & \sin\p{\phi/2} & \cos\p{\phi/2} & 0 \\
    0 & 0 & 0 & 1},
\end{multline}
which are generated by the Hamiltonians
\begin{align}
  t_0H\sp{R_z^{ST}\p\phi}=-\f\phi4\p{\sigma_x^1\sigma_x^2
    +\sigma_y^1\sigma_y^2},
\end{align}
\begin{align}
  t_0H\sp{R_x^{ST}\p\phi}=\f\phi4\p{\sigma_z^1-\sigma_z^2},
\end{align}
\begin{align}
  t_0H\sp{R_y^{ST}\p\phi}=\f\phi4\p{\sigma_y^1\sigma_x^2
    -\sigma_x^1\sigma_y^2}.
\end{align}
As the two terms in each of these Hamiltonians commute, the
corresponding operations may be applied sequentially.  The phase-flip,
bit-flip, and Hadamard gates are, respectively,
\begin{align}
  Z^{ST}=\op S-\op T+iI_r\cong R_z^{ST}\p\pi,
\end{align}
\begin{align}
  X^{ST}=\op{S}{T}+\op{T}{S}+iI_r\cong R_x^{ST}\p\pi,
\end{align}
\begin{align}
  \t{HG}^{ST}=\f1{\sqrt2}\sp{\p{\ket S+\ket T}\bra S +\p{\ket S-\ket
      T}\bra T}+iI_r\cong R_y^{ST}\p{\f\pi2}R_z^{ST}\p\pi.
\end{align}
Alternately, within the singlet-triplet subspace,
\begin{align}
  Z^{ST}\cong\t{SWAP}^{1,2}, && X^{ST}=Z^1, &&
  \t{HG}^{ST}=Z^1{\E^\dag}^{1,2}.
\end{align}

\newpage
\section*{Singlet-triplet / NV-center two qubit gates}

If we simply wish to read out a singlet-triplet qubit state, it is
sufficient to perform the operation
\begin{align}
  \mathcal R=\p{X\t{HG}}^{NV}\t{SWAP}^{NV,1}
\end{align}
and measure the state of the NV center. Here we can identify the
generating Hamiltonian
\begin{align}
  t_0H\sp{XHG}=\f\pi4\sigma_y.
\end{align}
This measurement procedure will leave one carbon nucleus in the
original state of the NV center, and will collapse the second carbon
nucleus onto an unknown state.

In order to perform coherent computations with the singlet-triplet
qubit, we construct an NV / singlet-triplet (ST) SWAP operation:
\begin{align}
  \t{SWAP}^{NV,ST}=\E^{1,2}\t{cNOT}^{1,2}
  \p{X\t{HG}}^{NV}\t{cNOT}^{NV,2}\t{SWAP}^{NV,1}.
\end{align}
In practice, we cannot couple nuclear spins directly, so we perform
the operation
\begin{align}
  \t{SWAP}^{NV,ST}=\t{SWAP}^{NV,1}\E^{NV,2}\t{cNOT}^{NV,2}
  \t{SWAP}^{NV,1}\p{X\t{HG}}^{NV}\t{cNOT}^{NV,2}\t{SWAP}^{NV,1}.
\end{align}
Wanting to replace SWAP operations with $i$SWAP operations, we can
equivalently rearrange the above to
\begin{align}
  \t{SWAP}^{NV,ST}=\p{X\t{HG}}^{NV}\t{SWAP}^{NV,1}\E^{NV,2}
  \t{cNOT}^{NV,2}{i\t{SWAP}^\dag}^{NV,1}\t{cNOT}^{NV,2}i\t{SWAP}^{NV,1},
  \label{swap_own}
\end{align}

Alternately, we can construct the SWAP gate from controlled-NOT
operations as
\begin{align}
  \t{SWAP}^{NV,ST}=\t{cNOT}^{NV,ST}\t{cNOT}^{ST,NV}\t{cNOT}^{NV,ST},
\end{align}
where
\begin{align}
  \t{cNOT}^{NV,ST}=\t{c}Z^{NV,1}, &&
  \t{cNOT}^{ST,NV}=\E^{1,2}\t{cNOT}^{1,NV}{\E^\dag}^{1,2}.
\end{align}
We can expand
\begin{align}
  \t{cNOT}^{ST,NV}&=\t{SWAP}^{NV,1}\E^{NV,2}\t{SWAP}^{NV,1}\t{cNOT}^{1,NV}
  \t{SWAP}^{NV,1}{\E^\dag}^{NV,2}\t{SWAP}^{NV,1} \\
  &=\t{SWAP}^{NV,1}\E^{NV,2}\t{cNOT}^{NV,1}{\E^\dag}^{NV,2}\t{SWAP}^{NV,1}.
\end{align}
Therefore
\begin{align}
  \t{SWAP}^{NV,ST}=\t{c}Z^{NV,1}\t{SWAP}^{NV,1}
  \E^{NV,2}\t{cNOT}^{NV,1}{\E^\dag}^{NV,2}
  \t{SWAP}^{NV,1}\t{c}Z^{NV,1},
\end{align}
which can further be reduced to
\begin{multline}
  \t{SWAP}^{NV,ST}= \\
  R_z^{NV}\p{\f\pi2}R_z^1\p{\f\pi2}{i\t{SWAP}^\dag}^{NV,1}
  \E^{NV,2}\t{cNOT}^{NV,1}{\E^\dag}^{NV,2}
  i\t{SWAP}^{NV,1}R_z^1\p{-\f\pi2}R_z^{NV}\p{-\f\pi2}.
  \label{swap_cnots}
\end{multline}
The constructions in (\ref{swap_own}) and (\ref{swap_cnots}) are
theoretically equal (up to global phase), but may have different
fidelities in practice.

Note that in order to function properly, $\t{SWAP}^{NV,ST}$ requires
the target carbon nuclei to be in a singlet-triplet state prior to
operation.

\newpage
\section*{New notation for NV/ST operations}

We introduce a new notation for operations:
\begin{align}
  U\sp{t_0H}=\exp\p{-it_0 H}.
\end{align}
In this notation,
\begin{align}
  R_{\uv n}\p\phi=U\sp{\f\phi2\sigma_{\uv n}},
\end{align}
\begin{align}
  \t{cNOT}^{m,n}=U\sp{\f\pi4\p{\sigma_z^m+\sigma_x^n
      -\sigma_z^m\sigma_x^n}} =R_z^m\p{\f\pi2} R_x^1\p{\f\pi2}
  U\sp{-\f\pi4\sigma_z^m\sigma_x^n}
\end{align}
\begin{align}
  i\t{SWAP}^{m,n}=U\sp{-\f\pi4\p{\sigma_x^m\sigma_x^n
      +\sigma_y^m\sigma_y^n}} =U\sp{-\f\pi4\sigma_y^m\sigma_y^n}
  U\sp{-\f\pi4\sigma_x^m\sigma_x^n},
\end{align}
\begin{align}
  \E^{m,n}=U\sp{-\f\pi4\sigma_y^m\sigma_x^n},
\end{align}
and therefore, defining
\begin{align}
  \mathcal M &={\E^\dag}^{NV,2} i\t{SWAP}^{NV,1}
  R_z^1\p{-\f\pi2}R_z^{NV}\p{-\f\pi2} \tag*{} \\
  &=U\sp{\f\pi4\sigma_y^{NV}\sigma_x^2}
  U\sp{-\f\pi4\sigma_y^{NV}\sigma_y^1}
  U\sp{-\f\pi4\sigma_x^{NV}\sigma_x^1}
  R_z^1\p{-\f\pi2}R_z^{NV}\p{-\f\pi2}
\end{align}
we can express
\begin{align}
  \t{SWAP}^{NV,ST}=\mathcal M^\dag R_z^{NV}\p{\f\pi2} R_x^1\p{\f\pi2}
  U\sp{-\f\pi4\sigma_z^{NV}\sigma_x^1} \mathcal M.
\end{align}

\section*{Optimizations}

When addressing larmor pairs with frequency $\omega_\l$, operations of
the form $\prod_{j\in\set{k:\omega_k=\omega_\l}}R_{\uv n}^j\p\phi$ are
easier to realize than individual rotations $R_{\uv n}^m\p\phi$. We
therefore define
\begin{align}
  \mathcal M'=U\sp{-\f\pi4\sigma_y^{NV}\sigma_y^2}
  U\sp{-\f\pi4\sigma_y^{NV}\sigma_y^1}
  U\sp{-\f\pi4\sigma_x^{NV}\sigma_x^1}
  \sp{\prod_{j\in\set{k:\omega_k=\omega_\l}}R_z^j\p{-\f\pi2}}
  R_z^{NV}\p{-\f\pi2}
\end{align}
and express $\t{SWAP}^{NV,ST}$ as
\begin{align}
  \t{SWAP}^{NV,ST}={\mathcal M'}^\dag R_z^{NV}\p{\f\pi2} R_x^1\p{\f\pi2}
  U\sp{-\f\pi4\sigma_z^{NV}\sigma_x^1} \mathcal M'.
\end{align}

\newpage
\section*{NV decoupling for single nuclear control}

We require
\begin{align}
  \abs{k_m\omega_{DD}-\omega_\l}\gg A,
\end{align}
where $k_m$ is a positive odd integer minimizing
$\abs{k\omega_{DD}-\omega_\l}$. This requirement implies
\begin{align}
  \omega_{DD}\gg A,
\end{align}
so we let
\begin{align}
  \abs{k_m\omega_{DD}-\omega_\l}=s_\Delta A,
\end{align}
and
\begin{align}
  \omega_{DD}=s_{DD}A
\end{align}
for some $s_\Delta,s_{DD}\gg1$, and express
\begin{align}
  k_m\omega_{DD}=\omega_\l\pm s_\Delta A.
\end{align}

\subsection*{Case 1: $\omega_\l \le s_\Delta A$}
In this case, as $k_m\omega_{DD}>0$,
\begin{align}
  k_m\omega_{DD}=\omega_\l+s_\Delta A.
\end{align}
Given that $k_m\ge 1$ and $\omega_{DD}>0$,
\begin{align}
  \omega_{DD}-\omega_\l\le k_m\omega_{DD}-\omega_\l.
\end{align}
As $\omega_{DD}\ge\omega_\l$, we know that $\omega_{DD}-\omega_\l>0$,
so that
\begin{align}
  \abs{\omega_{DD}-\omega_\l}<\abs{k_m\omega_{DD}-\omega_\l}.
\end{align}
By the definition of $k_m$, we must therefore have that $k_m=1$, which
means that
\begin{align}
  \omega_{DD}=\omega_\l+s_\Delta A.
\end{align}
In practice, we can use an AXY frequency
\begin{align}
  \omega_{DD}=\f13\p{\omega_\l+s_\Delta A}
  \label{w_DD_case1}
\end{align}
and set $f_1=0$.

\subsection*{Case 2: $\omega_\l > s_\Delta A$}
In this case we can possibly have
\begin{align}
  k_m\omega_{DD}=\omega_\l-s_\Delta A,
\end{align}
which we can write as
\begin{align}
  k_m s_{DD}=\f{\omega_\l}{A}-s_\Delta.
\end{align}
We therefore get that
\begin{align}
  s_{DD}=k_m^{-1}\p{\f{\omega_\l}{A}-s_\Delta}
\end{align}
and
\begin{align}
  \f{\omega_\l}{A}=k_m s_{DD}+s_\Delta,
\end{align}
which means that if we want to have a large $k_m$, we have to also
scale up $\omega_\l/A>s_\Delta\gg1$. We can alternately express
\begin{align}
  k_m=s_{DD}^{-1}\p{\f{\omega_\l}{A}-s_\Delta},
\end{align}
which means that if $s_{DD},s_\Delta>s$, then the maximum possible
value of $k_m$ is
\begin{align}
  k_M=\floor{s^{-1}\p{\f{\omega_\l}{A}-s}}
  =\floor{\f{\omega_\l}{sA}-1},
  \label{k_M}
\end{align}
so we set
\begin{align}
  \omega_{DD}=k_m^{-1}\p{\omega_\l-s_\Delta A}
  \label{w_DD_case2}
\end{align}
with
\begin{align}
  k_m=2\floor{\f{k_M}2}=\left\{
    \begin{array}{ll}
      k_M & k_M~\t{even} \\
      k_M-1 & k_M~\t{odd}
    \end{array}\right..
\end{align}
If (\ref{w_DD_case2}) does not satisfy $\omega_{DD}\gg A$, which by
construction is only possible when $k_m=0$, then we revert to using
(\ref{w_DD_case1}) with $f_1=0$.

\end{document}
